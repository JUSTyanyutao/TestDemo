define(["jquery","underscore","backbone","swiper","echo","app/utils","countdown","text!templates/main.html"],function(f,p,n,a,b,m,o,e){var i=f("#main-page");
var c=null;var h=null;var j=n.View.extend({el:i,render:function(){var q=this;l(q);d();},events:{"tap .goods-detail":"redirectGoodsDetail","tap .goods-flash-sale":"redirectFlashSale","tap .location":"redirectLocationPage",},redirectLocationPage:function(){window.location.hash="market";
},redirectFlashSale:function(){window.location.hash="mall/flash_sale";},redirectGoodsDetail:function(q){window.location.hash="goodsDetail/"+f(q.currentTarget).data("id");
}});var l=function(q){f.ajax({url:window.ctx+"main",type:"GET",dataType:"json",success:function(s){var r=p.template(e);q.$el.empty().append(r(s.result));
m.showPage(q.$el);g();k();if(c!=null){c.stop();}}});};var d=function(){var q=m.storage.get("market_name");if(q==""||q==null){q="请选择菜场";}console.info(i);
i.find(".market-name").text(q);};var g=function(){b.init({throttle:250,});if(h==null){h=window.setInterval(function(){b.render();},350);}};var k=function(){return new a(".swiper-container",{autoplay:3000,pagination:".swiper-pagination",paginationClickable:true,autoHeight:true,onTap:function(s){var r=f(s.clickedSlide).data("href");
if(r==""){return;}if(r.indexOf("farm://")>=0){var t=r.substr(7);var q=t.split("/");switch(parseInt(q[0])){case 1:window.location.hash="faq";break;case 2:window.location.hash="mall/hot";
break;case 3:window.location.hash="mall/specials";break;case 4:window.location.hash="mall/flash_sale";break;case 5:window.location.hash="order";break;case 6:window.location.hash="personalCenter";
break;case 7:window.location.hash="coupon";break;case 8:window.location.hash="feedback";break;case 9:window.location.hash="recharge";break;case 10:window.location.hash="goodsDetail/"+q[1];
break;}}else{window.location.href=r;}}});};return j;});